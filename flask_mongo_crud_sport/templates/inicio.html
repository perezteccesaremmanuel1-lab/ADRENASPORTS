<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Adrenasport - Tienda Deportiva</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root{
      --primary-blue: #0056b3;
      --secondary-blue: #003d82;
      --accent-orange: #ff6b00;
      --light-bg: #f8f9fa;
    }

    body{
      background-color: var(--light-bg);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .welcome-overlay{
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg,var(--primary-blue),var(--secondary-blue));
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
      opacity:1;
      transition: opacity .8s ease-out;
    }
    .welcome-content{ text-align:center; color:#fff; padding:20px; }
    .welcome-logo{ font-size:3.2rem; font-weight:800; letter-spacing:2px; margin-bottom:18px; }
    .welcome-message{ font-size:1.25rem; margin-bottom:20px; }
    .btn-entrar{
      background:#fff; color:var(--primary-blue);
      border-radius:25px; padding:10px 30px; font-weight:700;
      box-shadow:0 4px 12px rgba(0,0,0,.15);
    }

    .main-navbar{
      background: linear-gradient(135deg,var(--primary-blue),var(--secondary-blue));
      padding: .6rem 0;
    }

    .hero-section{
      background: linear-gradient(135deg, rgba(0,86,179,0.9), rgba(0,61,130,0.9)),
                  url('https://images.unsplash.com/photo-1552674605-db6ffd4facb5?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
      background-size:cover; background-position:center; color:#fff; padding:72px 0; margin-bottom:36px; text-align:center;
    }

    .product-card{
      border-radius:14px; overflow:hidden; background:#fff;
      box-shadow:0 6px 18px rgba(0,0,0,0.06); transition: transform .18s ease, box-shadow .18s ease;
    }
    .product-card:hover{ transform: translateY(-6px); box-shadow:0 12px 28px rgba(0,0,0,0.10); }

    .product-image{ width:100%; height:220px; object-fit:cover; }

    .product-badge{
      position:absolute; top:12px; right:12px;
      background:var(--accent-orange); color:#fff; padding:.3rem .8rem; border-radius:14px; font-size:.78rem; font-weight:700;
    }

    .product-price{ color:var(--primary-blue); font-weight:700; font-size:1.15rem; }
    .product-old-price{ text-decoration: line-through; color:#6c757d; font-size:.9rem; }
    .product-savings{ color:#28a745; font-weight:700; font-size:.85rem; }

  </style>
</head>
<body>

  <!-- Overlay -->
  <div class="welcome-overlay" id="welcomeOverlay">
    <div class="welcome-content">
      <div class="welcome-logo"><i class="bi bi-trophy-fill me-2"></i>Adrenasport</div>
      <div class="welcome-message">¡Bienvenido a la Mejor Tienda Deportiva!</div>
      <button class="btn-entrar" id="btnEntrar">Descubrir Productos <i class="bi bi-arrow-right ms-2"></i></button>
    </div>
  </div>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg main-navbar navbar-dark">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="{{ url_for('inicio') }}">
        <i class="bi bi-trophy-fill me-2"></i>Adrenasport
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarContent">

        <div class="search-container mx-lg-3 w-100">
          <form action="{{ url_for('buscar') }}" method="GET" class="d-flex">
            <input class="form-control search-box me-2" type="search" name="q"
            placeholder="Buscar productos..." value="{{ busqueda if busqueda else '' }}">
            <button class="btn search-btn" type="submit"><i class="bi bi-search"></i></button>
          </form>
        </div>

        <div class="categories-dropdown ms-lg-3">
          <div class="dropdown">
            <button class="btn dropdown-toggle text-white" data-bs-toggle="dropdown">
              <i class="bi bi-grid-3x3-gap-fill me-2"></i> Categorías
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="{{ url_for('inicio') }}">Todos</a></li>
              <li><a class="dropdown-item" href="{{ url_for('categoria', category='soccer') }}">Soccer</a></li>
              <li><a class="dropdown-item" href="{{ url_for('categoria', category='americano') }}">Americano</a></li>
              <li><a class="dropdown-item" href="{{ url_for('categoria', category='ropa') }}">Ropa</a></li>
            </ul>
          </div>
        </div>

        <div class="user-actions ms-lg-auto d-flex align-items-center">
          <span class="text-white me-3"><i class="bi bi-person-circle me-1"></i>{{ usuario if usuario else 'Invitado' }}</span>

          <a href="{{ url_for('carrito') }}" class="text-white me-3">
            <i class="bi bi-cart3"></i>
            {% set _carrito = session.get('carrito', []) %}
            {% if _carrito|length > 0 %}
              <span class="badge bg-danger ms-1">{{ _carrito|length }}</span>
            {% endif %}
          </a>

          <a href="{{ url_for('logout') }}" class="text-white">
            <i class="bi bi-box-arrow-right"></i>
          </a>
        </div>

      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="hero-section">
    <div class="container">
      <h1 class="hero-title">Adrenasport</h1>
      <p class="hero-subtitle">Equipamiento Profesional para Atletas</p>
    </div>
  </section>

  <!-- Productos -->
  <div class="container mb-5">

    <div class="row g-4">
      {% for producto in productos %}
      <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">

        <div class="product-card h-100 position-relative">

          <span class="product-badge">
            {{ producto.category|upper if producto.category else 'DEPORTE' }}
          </span>

          <img
            src="{{ producto.img if producto.img else 'https://via.placeholder.com/600x400/0056b3/fff?text=Adrenasport' }}"
            class="product-image"
            alt="{{ producto.name }}"
            onerror="this.src='https://via.placeholder.com/600x400/0056b3/fff?text=Adrenasport'">

          <div class="p-3 d-flex flex-column">
            <h6 class="fw-bold">{{ producto.name }}</h6>

            <span class="product-price">${{ producto.price }}</span>

            {% if producto.oldPrice and producto.oldPrice > producto.price %}
            <small class="text-muted d-block">{{ producto.oldPrice }} antes</small>
            <span class="product-savings">Ahorras ${{ producto.oldPrice - producto.price }}</span>
            {% endif %}

            <p class="text-muted small">
              {{ producto.description[:80] }}{% if producto.description|length > 80 %}...{% endif %}
            </p>

            <div class="mt-auto">
              <a href="{{ url_for('producto_detalle', producto_id=producto._id|string) }}" class="btn btn-outline-primary w-100 mb-2">
                Ver Detalles
              </a>

              <form method="POST" action="{{ url_for('agregar_carrito', producto_id=producto._id|string) }}">
                <button type="submit" class="btn btn-primary w-100">
                  Agregar al Carrito
                </button>
              </form>

            </div>
          </div>

        </div>

      </div>
      {% endfor %}
    </div>

  </div>

  <footer class="bg-dark text-white py-4 text-center">
    © 2024 Adrenasport
  </footer>

  <script>
    document.getElementById('btnEntrar').onclick = () => {
      const overlay = document.getElementById('welcomeOverlay');
      overlay.style.opacity = '0';
      setTimeout(() => overlay.style.display = 'none', 800);
    };
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
